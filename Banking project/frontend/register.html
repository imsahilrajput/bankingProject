<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Banking Application</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="styles/styles.css" />
    <style>
      input {
        all: unset;
        height: 35px;
      }
      a {
        pointer-events: none;
      }
      #myForm {
        padding-top: 100px;
      }
      a {
        pointer-events: all;
        text-decoration: none;
      }
      .registration-link {
        padding-top: 20px;
        padding-left: 206px;
      }
    </style>

    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <div id="myNav"></div>
    <div class="container">
      <h2 class="mb-5" style="text-align: center">Register With Us</h2>

      <div class="row">
        <div class="col-md-6 offset-md-3 registration-form" id="myForm">
          <form>
            <div class="form-group mb-3">
              <label for="firstName" class="form-label">First Name</label>
              <input
                type="text"
                class="form-control"
                id="firstName"
                data-firstName
              />
              <label for="lastName" class="form-label">Last Name</label>
              <input
                type="text"
                class="form-control"
                id="lastName"
                data-lastName
              />
              <label for="username" class="form-label">Username</label>
              <input
                type="text"
                class="form-control"
                id="username"
                data-username
              />
              <label for="emailId" class="form-label">Email id</label>
              <input
                type="text"
                class="form-control"
                id="emailId"
                data-emailId
              />
              <label for="password" class="form-label">Password</label>
              <input
                type="password"
                class="form-control"
                id="password"
                minlength="6"
                data-password
              />
              <label for="address" class="form-label">Address</label>
              <input
                type="text"
                class="form-control"
                id="address"
                data-address
              />

              <label for="phoneNumber" class="form-label">Phone Number</label>
              <input
                type="password"
                class="form-control"
                id="phone"
                minlength="10"
                data-Phone
              />
              <label for="dob" class="form-label">Date of Birth</label>
              <input
                type="date"
                class="form-control"
                id="dob"
                minlength="10"
                data-dob
              />
              <label for="phoneNumber" class="form-label">Cibil Score</label>
              <input
                type="text"
                class="form-control"
                id="cibil"
                minlength="10"
                data-cibil
              />
              <label for="phoneNumber" class="form-label">Monthly Salary</label>
              <input
                type="text"
                class="form-control"
                id="alary"
                minlength="10"
                data-salary
              />
            </div>

            <h3>Upload Salary Proof</h3>
            <form id="form" enctype="multipart/form-data">
                <div class="input-group  form-group ">
                    <label for="files">Select files  </label>
                
                    <input id="file" type="file" name="file" />
                </div>
                <button class="submit-btn btn btn-success" onclick="onUpload()" type="button">Sign in</button>
            </form>
            <div class="col-md-2 offset-md-5">
              <!-- <button type="button" class="btn btn-success" onclick="signIn()">
                Sign In
              </button> -->
            </div>
            <div class="col-md-12 registration-link">
              <a href="index.html">Already Registered? Login.</a>
            </div>
          </form>

          
          
            
            
        </div>
      </div>
    </div>

    <script src="js/bootstrap/bootstrap.bundle.min.js"></script>

    <script>
      $(function () {
        $("#myNav").load("nav.html");
      });

      function setNavBar() {
        var myInfo = document.getElementById("info");
        console.log(myInfo);
        myInfo.style.display = "none";
      }
      var firstName;
      var lastName ;
        var address ;
        var phoneNumber; 
        var emailId ;

        var username ;
        var password ;
        var dob;
        var cibilScore;
        var monthlySalary;
  
      

      function signIn() {
         firstName = document.querySelector("[data-firstName]").value;
         lastName = document.querySelector("[data-lastName]").value;
         address = document.querySelector("[data-address]").value;
         phoneNumber = document.querySelector("[data-phone]").value;
         emailId = document.querySelector("[data-emailId]").value;

         username = document.querySelector("[data-username]").value;
         password = document.querySelector("[data-password]").value;
         dob = document.querySelector("[data-dob]").value;
         cibilScore = document.querySelector("[data-cibil]").value;
         monthlySalary = document.querySelector("[data-salary]").value;
        

        // signInApiCall( firstName,lastName ,address,phoneNumber,emailId,username, password,dob,cibilScore,monthlySalary);
        onUpload();
      }

      // async function signInApiCall(data) {
      //   // console.log(data);

      //   let response = await fetch("http://localhost:5550/user", {
      //     mode: 'no-cors',
      //     headers: { "Content-type": "multipart/form-data" },
      //     method: "POST",
      //     body: JSON.stringify(data),
      //   });

      //   let datas = await response.json();
      //   console.log(datas.message);

      //   if (datas.message == "Successful") {
      //     //   sessionStorage.setItem("userId",datas.userId);
      //     window.alert("User Created Successfuly.");

      //     window.open("index.html", "_self");
      //   } else {
      //     window.alert("User Already Exists");

      //     window.open("register.html", "_self");
      //   }
      // }


      const onUpload = async ()=>{
        firstName = document.querySelector("[data-firstName]").value;
         lastName = document.querySelector("[data-lastName]").value;
         address = document.querySelector("[data-address]").value;
         phoneNumber = document.querySelector("[data-phone]").value;
         emailId = document.querySelector("[data-emailId]").value;

         username = document.querySelector("[data-username]").value;
         password = document.querySelector("[data-password]").value;
         dob = document.querySelector("[data-dob]").value;
         cibilScore = document.querySelector("[data-cibil]").value;
         monthlySalary = document.querySelector("[data-salary]").value;
        
        const inputFile = document.getElementById("file");
        const formData = new FormData();

        formData.append("file",inputFile.files[0]);
        formData.append("userName",username);
        formData.append("firstName",firstName);
        formData.append("lastName",lastName);
        formData.append("password",password);
        formData.append("address",address);
        formData.append("email",emailId);
        formData.append("phoneNumber",phoneNumber);
        formData.append("role","client");
        formData.append("dob",dob);
        formData.append("cibilScore",cibilScore);
        formData.append("monthlySalary",monthlySalary);
        const response = await fetch("http://localhost:5550/user", {
          method: "POST",
          body: formData,
        }).catch(error=>{
          console.log(error);
        });
        const datas = await response.json();
        console.log(datas);
           if (datas.message == "Successful") {
          //   sessionStorage.setItem("userId",datas.userId);
          window.alert("User Created Successfuly.");

          window.open("index.html", "_self");
        } else {
          window.alert("User Already Exists");

          window.open("register.html", "_self");
        }

      }
    </script>
  </body>
</html>
